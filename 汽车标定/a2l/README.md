# A2L



## A2L和DBC的区别

A2L文件是由ASAM MCD-2 MC标准定义的用于测量和标定目的的内部ECU变量的描述格式。标定指在调整ECU的功能相关的参数（标量，曲线和脉谱）以实现和优化相关的系统性能。

DBC文件是一种专有格式（归于Vector公司），用于描述CAN总线上的数据。

两者的关系可以在下图中找到：

![img](https://pic1.zhimg.com/v2-cea99fb11ca6f16652379da97a641ea4_b.jpg)





## A2L文件介绍

![](https://pic4.zhimg.com/v2-5f64d10265f6e6c8e4965d91718c2292_1200x500.jpg)

A2L标准分为三个部分，分别是：

1）ASAP-1 标准定义了标定系统与 ECU 之间的通信接口其又可以分为两层：ASAP-1a 规定了标定系统与 ECU 通信的物理接口和逻辑接口规范；ASAP-1b 规定了标定系统与 ECU 之间的驱动代码规范。

2）ASAP-2 标准规定了 ECU 内部数据单元描述文件规范，包括标定系统与ECU 通信的配置参数和 ECU 内部数据单元的变量地址、转换方法等详细信息。

3）ASAP-3 标准规定了标定系统远程控制通信协议。

三部分之间的关系如图1所示。

A2L 文件包括(如图2所示)：设备参数信息、接口数据信息和 ECU 参数信息。参数信息描述了 ECU 的基本信息和 ECU  数据单元的一些公共属性；接口数据信息描述了标定系统与 ECU 通信时所需配置的接口信息；ECU 参数信息描述了内部数据单元的详细内容。

![](https://pic4.zhimg.com/80/v2-a644dd21285d0fa0c1522afa9f204b2b_720w.jpg)

图2中不同块的意义如下：

> **HEADER**该块里边包含了项目信息，包括项目编号，项目版本等信息
>
> **MODULE**该块里边包含了在标定测量层面来描述ECU需要的所有信息，一个ECU对应一个MODULE块，MODULE由许多子块来组成1MOD_PAR这个块里包含了用于管理ECU的数据，例如客户名，编号，CPU类型，ECU的内存分配等，其中最重要的就是ECU的内存分配，开发人员需要根据ECU内存分段情况定义MEMORY  SEGMENT和SEGMENT里边的PAGE，这里的SEGMENT/PAGE的概念和在线标定中的概念是一致的，一个MODULE里边只能出现一次。
>
> **MOD_COMMON**该块用来指定ECU的一些标准的一般性描述信息，比如大小端，数据的对齐方式，FLOAT变量的处理方式等，一个MODULE里也只能出现一次。
>
> **CHARACTERISTIC**该块用来定义标定变量，里边包含了可以被标定的变量的名字，地址，长度，计算公式，精度，最大最小值等信息，一个MODULE里边可以出现很多次这样的块，也就是说一个ECU可以有很多的标定变量。
>
> **AXIS_PTS**该块用来定义数组或查表变量对应的轴的类型，它将被RECORD_LAYOUT块来引用，一个ECU里边可以有很多种不同的轴类型，用于实现查表和插值，一般很少用到。**MEASUREMENT**该块用来定义测量变量，里边包含了可以被测量的变量的名字，地址，长度，计算公式，精度，最大最小值等信息，一个MODULE里边可以出现很多次这样的块，也就是说一个ECU可以有很多的测量变量。
>
> **COMPU_METHOD**该块用于定义计算公式，及原始值和物理值之前的转换关系，这些公式可以被标定变量和测量变量来引用，从而将原始值转换成便于用户阅读和使用的物理值。**COMPU_TAB**该块用来定义原始值和物理值的映射关系，是一种特殊的转换关系，它一般应用于枚举变量，例如我们想采集一个代表XCP状态机的变量，分别为0对应DISCONNECTED，1对应CONNECTED，2对应RESUME，那么我们就可以把这样的映射关系定义成一个COMPU_TAB，然后关联到对应的变量上，这时候如果上位机采集到1这样的原始值，它就可以将当前的状态显示成“CONNECTED”字样，方便用于阅读和使用。**FUNCTION**该块为可选项，很少使用。
>
> **GROUPS**该块是把标定变量和测量变量按照一定的逻辑（比如功能模块）组织起来，在上位机中形成一个下拉菜单，使得用于可以从中选择变量，这块是可选的。
>
> **RECORD_LAYOUT**该块用来定义标定变量的物理存储结构（单个变量，二维表，三维表等）。































